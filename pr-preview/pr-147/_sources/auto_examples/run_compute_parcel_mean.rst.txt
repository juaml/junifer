
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/run_compute_parcel_mean.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_run_compute_parcel_mean.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_run_compute_parcel_mean.py:


Computer Parcel Aggregation.
============================

This example uses a ParcelAggregation marker to compute the mean of each parcel
using the Schaefer parcellations (100 rois, 7 Yeo networks) for both a 3D and
4D nifti

Authors: Federico Raimondo

License: BSD 3 clause

.. GENERATED FROM PYTHON SOURCE LINES 13-20

.. code-block:: default


    import nilearn

    from junifer.markers.parcel_aggregation import ParcelAggregation
    from junifer.utils import configure_logging









.. GENERATED FROM PYTHON SOURCE LINES 21-22

Set the logging level to info to see extra information

.. GENERATED FROM PYTHON SOURCE LINES 22-25

.. code-block:: default

    configure_logging(level="INFO")






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2023-03-14 15:22:54,119 - JUNIFER - INFO - ===== Lib Versions =====
    2023-03-14 15:22:54,119 - JUNIFER - INFO - numpy: 1.23.5
    2023-03-14 15:22:54,119 - JUNIFER - INFO - scipy: 1.10.1
    2023-03-14 15:22:54,119 - JUNIFER - INFO - pandas: 1.5.3
    2023-03-14 15:22:54,119 - JUNIFER - INFO - nilearn: 0.10.0
    2023-03-14 15:22:54,119 - JUNIFER - INFO - nibabel: 4.0.2
    2023-03-14 15:22:54,119 - JUNIFER - INFO - junifer: 0.1.dev1
    2023-03-14 15:22:54,119 - JUNIFER - INFO - ========================




.. GENERATED FROM PYTHON SOURCE LINES 26-28

Load the VBM GM data (3d):
- Fetch the Oasis dataset

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: default

    oasis_dataset = nilearn.datasets.fetch_oasis_vbm(n_subjects=1)
    vbm_fname = oasis_dataset.gray_matter_maps[0]
    vbm_img = nilearn.image.load_img(vbm_fname)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Dataset created in /home/runner/nilearn_data/oasis1

    Downloading data from https://www.nitrc.org/frs/download.php/6364/archive_dartel.tgz ...
    Downloaded 4341760 of 905208634 bytes (0.5%,  3.7min remaining)    Downloaded 11067392 of 905208634 bytes (1.2%,  2.8min remaining)    Downloaded 18128896 of 905208634 bytes (2.0%,  2.5min remaining)    Downloaded 25624576 of 905208634 bytes (2.8%,  2.4min remaining)    Downloaded 31498240 of 905208634 bytes (3.5%,  2.4min remaining)    Downloaded 35938304 of 905208634 bytes (4.0%,  2.5min remaining)    Downloaded 40443904 of 905208634 bytes (4.5%,  2.6min remaining)    Downloaded 43565056 of 905208634 bytes (4.8%,  2.7min remaining)    Downloaded 45654016 of 905208634 bytes (5.0%,  2.9min remaining)    Downloaded 47398912 of 905208634 bytes (5.2%,  3.1min remaining)    Downloaded 49143808 of 905208634 bytes (5.4%,  3.3min remaining)    Downloaded 51027968 of 905208634 bytes (5.6%,  3.4min remaining)    Downloaded 53026816 of 905208634 bytes (5.9%,  3.6min remaining)    Downloaded 55017472 of 905208634 bytes (6.1%,  3.7min remaining)    Downloaded 56852480 of 905208634 bytes (6.3%,  3.8min remaining)    Downloaded 58875904 of 905208634 bytes (6.5%,  3.9min remaining)    Downloaded 61161472 of 905208634 bytes (6.8%,  4.0min remaining)    Downloaded 63365120 of 905208634 bytes (7.0%,  4.1min remaining)    Downloaded 65708032 of 905208634 bytes (7.3%,  4.1min remaining)    Downloaded 68067328 of 905208634 bytes (7.5%,  4.2min remaining)    Downloaded 70590464 of 905208634 bytes (7.8%,  4.2min remaining)    Downloaded 73367552 of 905208634 bytes (8.1%,  4.3min remaining)    Downloaded 76242944 of 905208634 bytes (8.4%,  4.3min remaining)    Downloaded 79642624 of 905208634 bytes (8.8%,  4.2min remaining)    Downloaded 84017152 of 905208634 bytes (9.3%,  4.2min remaining)    Downloaded 88293376 of 905208634 bytes (9.8%,  4.1min remaining)    Downloaded 92225536 of 905208634 bytes (10.2%,  4.1min remaining)    Downloaded 94928896 of 905208634 bytes (10.5%,  4.1min remaining)    Downloaded 96862208 of 905208634 bytes (10.7%,  4.1min remaining)    Downloaded 98934784 of 905208634 bytes (10.9%,  4.2min remaining)    Downloaded 101097472 of 905208634 bytes (11.2%,  4.2min remaining)    Downloaded 103399424 of 905208634 bytes (11.4%,  4.2min remaining)    Downloaded 105816064 of 905208634 bytes (11.7%,  4.2min remaining)    Downloaded 108371968 of 905208634 bytes (12.0%,  4.2min remaining)    Downloaded 111124480 of 905208634 bytes (12.3%,  4.3min remaining)    Downloaded 113606656 of 905208634 bytes (12.6%,  4.3min remaining)    Downloaded 116056064 of 905208634 bytes (12.8%,  4.3min remaining)    Downloaded 118767616 of 905208634 bytes (13.1%,  4.3min remaining)    Downloaded 121692160 of 905208634 bytes (13.4%,  4.3min remaining)    Downloaded 124534784 of 905208634 bytes (13.8%,  4.3min remaining)    Downloaded 126836736 of 905208634 bytes (14.0%,  4.3min remaining)    Downloaded 129335296 of 905208634 bytes (14.3%,  4.3min remaining)    Downloaded 132177920 of 905208634 bytes (14.6%,  4.3min remaining)    Downloaded 134987776 of 905208634 bytes (14.9%,  4.3min remaining)    Downloaded 137863168 of 905208634 bytes (15.2%,  4.3min remaining)    Downloaded 140804096 of 905208634 bytes (15.6%,  4.2min remaining)    Downloaded 143712256 of 905208634 bytes (15.9%,  4.2min remaining)    Downloaded 146808832 of 905208634 bytes (16.2%,  4.2min remaining)    Downloaded 150167552 of 905208634 bytes (16.6%,  4.2min remaining)    Downloaded 153788416 of 905208634 bytes (17.0%,  4.1min remaining)    Downloaded 158089216 of 905208634 bytes (17.5%,  4.1min remaining)    Downloaded 163446784 of 905208634 bytes (18.1%,  4.0min remaining)    Downloaded 169050112 of 905208634 bytes (18.7%,  3.9min remaining)    Downloaded 174350336 of 905208634 bytes (19.3%,  3.8min remaining)    Downloaded 179789824 of 905208634 bytes (19.9%,  3.8min remaining)    Downloaded 184311808 of 905208634 bytes (20.4%,  3.7min remaining)    Downloaded 189153280 of 905208634 bytes (20.9%,  3.7min remaining)    Downloaded 194248704 of 905208634 bytes (21.5%,  3.6min remaining)    Downloaded 199303168 of 905208634 bytes (22.0%,  3.5min remaining)    Downloaded 203694080 of 905208634 bytes (22.5%,  3.5min remaining)    Downloaded 207831040 of 905208634 bytes (23.0%,  3.5min remaining)    Downloaded 212402176 of 905208634 bytes (23.5%,  3.4min remaining)    Downloaded 217047040 of 905208634 bytes (24.0%,  3.4min remaining)    Downloaded 220758016 of 905208634 bytes (24.4%,  3.4min remaining)    Downloaded 224739328 of 905208634 bytes (24.8%,  3.3min remaining)    Downloaded 227786752 of 905208634 bytes (25.2%,  3.3min remaining)    Downloaded 231153664 of 905208634 bytes (25.5%,  3.3min remaining)    Downloaded 234029056 of 905208634 bytes (25.9%,  3.3min remaining)    Downloaded 236756992 of 905208634 bytes (26.2%,  3.3min remaining)    Downloaded 239632384 of 905208634 bytes (26.5%,  3.3min remaining)    Downloaded 242597888 of 905208634 bytes (26.8%,  3.3min remaining)    Downloaded 245620736 of 905208634 bytes (27.1%,  3.3min remaining)    Downloaded 248774656 of 905208634 bytes (27.5%,  3.3min remaining)    Downloaded 251551744 of 905208634 bytes (27.8%,  3.3min remaining)    Downloaded 254345216 of 905208634 bytes (28.1%,  3.2min remaining)    Downloaded 257474560 of 905208634 bytes (28.4%,  3.2min remaining)    Downloaded 260743168 of 905208634 bytes (28.8%,  3.2min remaining)    Downloaded 263987200 of 905208634 bytes (29.2%,  3.2min remaining)    Downloaded 267280384 of 905208634 bytes (29.5%,  3.2min remaining)    Downloaded 270598144 of 905208634 bytes (29.9%,  3.2min remaining)    Downloaded 274030592 of 905208634 bytes (30.3%,  3.2min remaining)    Downloaded 277577728 of 905208634 bytes (30.7%,  3.1min remaining)    Downloaded 281501696 of 905208634 bytes (31.1%,  3.1min remaining)    Downloaded 285982720 of 905208634 bytes (31.6%,  3.1min remaining)    Downloaded 291217408 of 905208634 bytes (32.2%,  3.0min remaining)    Downloaded 297631744 of 905208634 bytes (32.9%,  3.0min remaining)    Downloaded 304775168 of 905208634 bytes (33.7%,  2.9min remaining)    Downloaded 311123968 of 905208634 bytes (34.4%,  2.8min remaining)    Downloaded 318177280 of 905208634 bytes (35.1%,  2.8min remaining)    Downloaded 326139904 of 905208634 bytes (36.0%,  2.7min remaining)    Downloaded 334069760 of 905208634 bytes (36.9%,  2.6min remaining)    Downloaded 342114304 of 905208634 bytes (37.8%,  2.6min remaining)    Downloaded 350240768 of 905208634 bytes (38.7%,  2.5min remaining)    Downloaded 358359040 of 905208634 bytes (39.6%,  2.4min remaining)    Downloaded 366559232 of 905208634 bytes (40.5%,  2.4min remaining)    Downloaded 375013376 of 905208634 bytes (41.4%,  2.3min remaining)    Downloaded 382164992 of 905208634 bytes (42.2%,  2.2min remaining)    Downloaded 388923392 of 905208634 bytes (43.0%,  2.2min remaining)    Downloaded 396222464 of 905208634 bytes (43.8%,  2.1min remaining)    Downloaded 402391040 of 905208634 bytes (44.5%,  2.1min remaining)    Downloaded 408461312 of 905208634 bytes (45.1%,  2.1min remaining)    Downloaded 414826496 of 905208634 bytes (45.8%,  2.0min remaining)    Downloaded 421421056 of 905208634 bytes (46.6%,  2.0min remaining)    Downloaded 428122112 of 905208634 bytes (47.3%,  2.0min remaining)    Downloaded 434642944 of 905208634 bytes (48.0%,  1.9min remaining)    Downloaded 441171968 of 905208634 bytes (48.7%,  1.9min remaining)    Downloaded 447741952 of 905208634 bytes (49.5%,  1.8min remaining)    Downloaded 453582848 of 905208634 bytes (50.1%,  1.8min remaining)    Downloaded 459235328 of 905208634 bytes (50.7%,  1.8min remaining)    Downloaded 463732736 of 905208634 bytes (51.2%,  1.8min remaining)    Downloaded 468484096 of 905208634 bytes (51.8%,  1.7min remaining)    Downloaded 473636864 of 905208634 bytes (52.3%,  1.7min remaining)    Downloaded 478191616 of 905208634 bytes (52.8%,  1.7min remaining)    Downloaded 482320384 of 905208634 bytes (53.3%,  1.7min remaining)    Downloaded 486883328 of 905208634 bytes (53.8%,  1.7min remaining)    Downloaded 491872256 of 905208634 bytes (54.3%,  1.6min remaining)    Downloaded 496893952 of 905208634 bytes (54.9%,  1.6min remaining)    Downloaded 502095872 of 905208634 bytes (55.5%,  1.6min remaining)    Downloaded 507158528 of 905208634 bytes (56.0%,  1.6min remaining)    Downloaded 512417792 of 905208634 bytes (56.6%,  1.6min remaining)    Downloaded 517660672 of 905208634 bytes (57.2%,  1.5min remaining)    Downloaded 522960896 of 905208634 bytes (57.8%,  1.5min remaining)    Downloaded 528809984 of 905208634 bytes (58.4%,  1.5min remaining)    Downloaded 534831104 of 905208634 bytes (59.1%,  1.5min remaining)    Downloaded 540221440 of 905208634 bytes (59.7%,  1.4min remaining)    Downloaded 544473088 of 905208634 bytes (60.1%,  1.4min remaining)    Downloaded 547594240 of 905208634 bytes (60.5%,  1.4min remaining)    Downloaded 550961152 of 905208634 bytes (60.9%,  1.4min remaining)    Downloaded 554377216 of 905208634 bytes (61.2%,  1.4min remaining)    Downloaded 557916160 of 905208634 bytes (61.6%,  1.4min remaining)    Downloaded 561471488 of 905208634 bytes (62.0%,  1.4min remaining)    Downloaded 564895744 of 905208634 bytes (62.4%,  1.3min remaining)    Downloaded 567934976 of 905208634 bytes (62.7%,  1.3min remaining)    Downloaded 571383808 of 905208634 bytes (63.1%,  1.3min remaining)    Downloaded 574996480 of 905208634 bytes (63.5%,  1.3min remaining)    Downloaded 578781184 of 905208634 bytes (63.9%,  1.3min remaining)    Downloaded 582492160 of 905208634 bytes (64.3%,  1.3min remaining)    Downloaded 586301440 of 905208634 bytes (64.8%,  1.3min remaining)    Downloaded 589889536 of 905208634 bytes (65.2%,  1.3min remaining)    Downloaded 592912384 of 905208634 bytes (65.5%,  1.2min remaining)    Downloaded 596426752 of 905208634 bytes (65.9%,  1.2min remaining)    Downloaded 600113152 of 905208634 bytes (66.3%,  1.2min remaining)    Downloaded 603308032 of 905208634 bytes (66.6%,  1.2min remaining)    Downloaded 606380032 of 905208634 bytes (67.0%,  1.2min remaining)    Downloaded 609550336 of 905208634 bytes (67.3%,  1.2min remaining)    Downloaded 612843520 of 905208634 bytes (67.7%,  1.2min remaining)    Downloaded 616153088 of 905208634 bytes (68.1%,  1.2min remaining)    Downloaded 619626496 of 905208634 bytes (68.5%,  1.2min remaining)    Downloaded 623239168 of 905208634 bytes (68.9%,  1.1min remaining)    Downloaded 627040256 of 905208634 bytes (69.3%,  1.1min remaining)    Downloaded 630562816 of 905208634 bytes (69.7%,  1.1min remaining)    Downloaded 633806848 of 905208634 bytes (70.0%,  1.1min remaining)    Downloaded 637468672 of 905208634 bytes (70.4%,  1.1min remaining)    Downloaded 641318912 of 905208634 bytes (70.8%,  1.1min remaining)    Downloaded 645283840 of 905208634 bytes (71.3%,  1.1min remaining)    Downloaded 649117696 of 905208634 bytes (71.7%,  1.0min remaining)    Downloaded 653066240 of 905208634 bytes (72.1%,  1.0min remaining)    Downloaded 657031168 of 905208634 bytes (72.6%,  1.0min remaining)    Downloaded 660299776 of 905208634 bytes (72.9%,   59.8s remaining)    Downloaded 663732224 of 905208634 bytes (73.3%,   59.0s remaining)    Downloaded 667328512 of 905208634 bytes (73.7%,   58.2s remaining)    Downloaded 670203904 of 905208634 bytes (74.0%,   57.6s remaining)    Downloaded 673415168 of 905208634 bytes (74.4%,   56.9s remaining)    Downloaded 676691968 of 905208634 bytes (74.8%,   56.2s remaining)    Downloaded 679936000 of 905208634 bytes (75.1%,   55.4s remaining)    Downloaded 682582016 of 905208634 bytes (75.4%,   54.9s remaining)    Downloaded 685023232 of 905208634 bytes (75.7%,   54.4s remaining)    Downloaded 687382528 of 905208634 bytes (75.9%,   54.0s remaining)    Downloaded 689840128 of 905208634 bytes (76.2%,   53.5s remaining)    Downloaded 692314112 of 905208634 bytes (76.5%,   53.0s remaining)    Downloaded 695001088 of 905208634 bytes (76.8%,   52.4s remaining)    Downloaded 697769984 of 905208634 bytes (77.1%,   51.9s remaining)    Downloaded 699981824 of 905208634 bytes (77.3%,   51.4s remaining)    Downloaded 702636032 of 905208634 bytes (77.6%,   50.9s remaining)    Downloaded 705372160 of 905208634 bytes (77.9%,   50.3s remaining)    Downloaded 708222976 of 905208634 bytes (78.2%,   49.6s remaining)    Downloaded 711147520 of 905208634 bytes (78.6%,   49.0s remaining)    Downloaded 713973760 of 905208634 bytes (78.9%,   48.3s remaining)    Downloaded 716677120 of 905208634 bytes (79.2%,   47.8s remaining)    Downloaded 719208448 of 905208634 bytes (79.5%,   47.2s remaining)    Downloaded 721952768 of 905208634 bytes (79.8%,   46.6s remaining)    Downloaded 724639744 of 905208634 bytes (80.1%,   46.0s remaining)    Downloaded 726949888 of 905208634 bytes (80.3%,   45.5s remaining)    Downloaded 729399296 of 905208634 bytes (80.6%,   45.0s remaining)    Downloaded 731414528 of 905208634 bytes (80.8%,   44.6s remaining)    Downloaded 733061120 of 905208634 bytes (81.0%,   44.3s remaining)    Downloaded 734740480 of 905208634 bytes (81.2%,   44.0s remaining)    Downloaded 736116736 of 905208634 bytes (81.3%,   43.8s remaining)    Downloaded 737730560 of 905208634 bytes (81.5%,   43.5s remaining)    Downloaded 739434496 of 905208634 bytes (81.7%,   43.2s remaining)    Downloaded 740909056 of 905208634 bytes (81.8%,   43.0s remaining)    Downloaded 742457344 of 905208634 bytes (82.0%,   42.7s remaining)    Downloaded 743784448 of 905208634 bytes (82.2%,   42.5s remaining)    Downloaded 745209856 of 905208634 bytes (82.3%,   42.3s remaining)    Downloaded 746733568 of 905208634 bytes (82.5%,   42.0s remaining)    Downloaded 748453888 of 905208634 bytes (82.7%,   41.7s remaining)    Downloaded 749993984 of 905208634 bytes (82.9%,   41.4s remaining)    Downloaded 751452160 of 905208634 bytes (83.0%,   41.1s remaining)    Downloaded 752746496 of 905208634 bytes (83.2%,   40.9s remaining)    Downloaded 754171904 of 905208634 bytes (83.3%,   40.7s remaining)    Downloaded 755703808 of 905208634 bytes (83.5%,   40.4s remaining)    Downloaded 757399552 of 905208634 bytes (83.7%,   40.0s remaining)    Downloaded 759291904 of 905208634 bytes (83.9%,   39.6s remaining)    Downloaded 761282560 of 905208634 bytes (84.1%,   39.1s remaining)    Downloaded 763445248 of 905208634 bytes (84.3%,   38.6s remaining)    Downloaded 765829120 of 905208634 bytes (84.6%,   38.1s remaining)    Downloaded 768679936 of 905208634 bytes (84.9%,   37.3s remaining)    Downloaded 771973120 of 905208634 bytes (85.3%,   36.4s remaining)    Downloaded 775151616 of 905208634 bytes (85.6%,   35.6s remaining)    Downloaded 778797056 of 905208634 bytes (86.0%,   34.6s remaining)    Downloaded 782614528 of 905208634 bytes (86.5%,   33.5s remaining)    Downloaded 786472960 of 905208634 bytes (86.9%,   32.5s remaining)    Downloaded 790478848 of 905208634 bytes (87.3%,   31.4s remaining)    Downloaded 794386432 of 905208634 bytes (87.8%,   30.3s remaining)    Downloaded 798294016 of 905208634 bytes (88.2%,   29.2s remaining)    Downloaded 802463744 of 905208634 bytes (88.6%,   28.1s remaining)    Downloaded 806789120 of 905208634 bytes (89.1%,   26.9s remaining)    Downloaded 811491328 of 905208634 bytes (89.6%,   25.6s remaining)    Downloaded 815661056 of 905208634 bytes (90.1%,   24.4s remaining)    Downloaded 820158464 of 905208634 bytes (90.6%,   23.2s remaining)    Downloaded 824983552 of 905208634 bytes (91.1%,   21.8s remaining)    Downloaded 830021632 of 905208634 bytes (91.7%,   20.4s remaining)    Downloaded 835158016 of 905208634 bytes (92.3%,   19.0s remaining)    Downloaded 839991296 of 905208634 bytes (92.8%,   17.6s remaining)    Downloaded 844152832 of 905208634 bytes (93.3%,   16.5s remaining)    Downloaded 847831040 of 905208634 bytes (93.7%,   15.5s remaining)    Downloaded 851255296 of 905208634 bytes (94.0%,   14.6s remaining)    Downloaded 854032384 of 905208634 bytes (94.3%,   13.9s remaining)    Downloaded 857071616 of 905208634 bytes (94.7%,   13.1s remaining)    Downloaded 860200960 of 905208634 bytes (95.0%,   12.2s remaining)    Downloaded 863346688 of 905208634 bytes (95.4%,   11.4s remaining)    Downloaded 866213888 of 905208634 bytes (95.7%,   10.6s remaining)    Downloaded 868925440 of 905208634 bytes (96.0%,    9.9s remaining)    Downloaded 872022016 of 905208634 bytes (96.3%,    9.0s remaining)    Downloaded 875216896 of 905208634 bytes (96.7%,    8.2s remaining)    Downloaded 878485504 of 905208634 bytes (97.0%,    7.3s remaining)    Downloaded 881729536 of 905208634 bytes (97.4%,    6.4s remaining)    Downloaded 884359168 of 905208634 bytes (97.7%,    5.7s remaining)    Downloaded 887275520 of 905208634 bytes (98.0%,    4.9s remaining)    Downloaded 890347520 of 905208634 bytes (98.4%,    4.1s remaining)    Downloaded 893616128 of 905208634 bytes (98.7%,    3.2s remaining)    Downloaded 896081920 of 905208634 bytes (99.0%,    2.5s remaining)    Downloaded 898072576 of 905208634 bytes (99.2%,    2.0s remaining)    Downloaded 900186112 of 905208634 bytes (99.4%,    1.4s remaining)    Downloaded 902373376 of 905208634 bytes (99.7%,    0.8s remaining)    Downloaded 904708096 of 905208634 bytes (99.9%,    0.1s remaining) ...done. (250 seconds, 4 min)
    Extracting data from /home/runner/nilearn_data/oasis1/6d19418bccb98b1333309bd8baa05152/archive_dartel.tgz..... done.
    /opt/hostedtoolcache/Python/3.10.10/x64/lib/python3.10/site-packages/nilearn/datasets/struct.py:733: UserWarning: `legacy_format` will default to `False` in release 0.11. Dataset fetchers will then return pandas dataframes by default instead of recarrays.
      warnings.warn(_LEGACY_FORMAT_MSG)




.. GENERATED FROM PYTHON SOURCE LINES 33-36

Load the functional data (4d):
- Fetch the SPM auditory dataset
- Concatenate the functional data into one 4D image

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default

    s_func_data = nilearn.datasets.fetch_spm_auditory()
    fmri_img = nilearn.image.concat_imgs(s_func_data.func)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Dataset created in /home/runner/nilearn_data/spm_auditory

    Data absent, downloading...
    Downloading data from http://www.fil.ion.ucl.ac.uk/spm/download/data/MoAEpilot/MoAEpilot.zip ...
    Downloaded 1253376 of 34212021 bytes (3.7%,   26.8s remaining)    Downloaded 7479296 of 34212021 bytes (21.9%,    7.3s remaining)    Downloaded 13737984 of 34212021 bytes (40.2%,    4.5s remaining)    Downloaded 19128320 of 34212021 bytes (55.9%,    3.2s remaining)    Downloaded 24854528 of 34212021 bytes (72.6%,    1.9s remaining)    Downloaded 30777344 of 34212021 bytes (90.0%,    0.7s remaining) ...done. (8 seconds, 0 min)
    Extracting data from /home/runner/nilearn_data/spm_auditory/sub001/MoAEpilot.zip..... done.




.. GENERATED FROM PYTHON SOURCE LINES 40-41

Define the marker

.. GENERATED FROM PYTHON SOURCE LINES 41-43

.. code-block:: default

    marker = ParcelAggregation(parcellation="Schaefer100x7", method="mean")








.. GENERATED FROM PYTHON SOURCE LINES 44-45

Prepare the input

.. GENERATED FROM PYTHON SOURCE LINES 45-50

.. code-block:: default

    input = {
        "BOLD": {"data": fmri_img, "meta": {"element": "subject1"}},
        "VBM_GM": {"data": vbm_img, "meta": {"element": "subject1"}},
    }








.. GENERATED FROM PYTHON SOURCE LINES 51-52

Fit transform the data

.. GENERATED FROM PYTHON SOURCE LINES 52-54

.. code-block:: default

    out = marker.fit_transform(input)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2023-03-14 15:27:23,456 - JUNIFER - INFO - Computing BOLD
    2023-03-14 15:27:23,457 - JUNIFER - INFO - Fetching one of Schaefer parcellations.
    2023-03-14 15:27:23,457 - JUNIFER - INFO - Parcellation parameters:
    2023-03-14 15:27:23,457 - JUNIFER - INFO -      n_rois: 100
    2023-03-14 15:27:23,457 - JUNIFER - INFO -      yeo_networks: 7
    2023-03-14 15:27:23,457 - JUNIFER - INFO -      resolution: 3.0
    2023-03-14 15:27:23,458 - JUNIFER - INFO - At least one of the parcellation files are missing. Fetching using nilearn.

    Dataset created in /home/runner/junifer/data/parcellations/schaefer_2018

    Downloading data from https://raw.githubusercontent.com/ThomasYeoLab/CBIG/v0.14.3-Update_Yeo2011_Schaefer2018_labelname/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal/Parcellations/MNI/Schaefer2018_100Parcels_7Networks_order.txt ...
     ...done. (0 seconds, 0 min)
    Downloading data from https://raw.githubusercontent.com/ThomasYeoLab/CBIG/v0.14.3-Update_Yeo2011_Schaefer2018_labelname/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal/Parcellations/MNI/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz ...
     ...done. (0 seconds, 0 min)
    2023-03-14 15:27:23,911 - JUNIFER - INFO - Loading parcellation /home/runner/junifer/data/parcellations/schaefer_2018/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz
    2023-03-14 15:27:26,420 - JUNIFER - INFO - No storage specified, returning dictionary
    2023-03-14 15:27:26,420 - JUNIFER - INFO - Computing VBM_GM
    2023-03-14 15:27:26,421 - JUNIFER - INFO - Fetching one of Schaefer parcellations.
    2023-03-14 15:27:26,421 - JUNIFER - INFO - Parcellation parameters:
    2023-03-14 15:27:26,421 - JUNIFER - INFO -      n_rois: 100
    2023-03-14 15:27:26,421 - JUNIFER - INFO -      yeo_networks: 7
    2023-03-14 15:27:26,421 - JUNIFER - INFO -      resolution: 2.0
    2023-03-14 15:27:26,424 - JUNIFER - INFO - Loading parcellation /home/runner/junifer/data/parcellations/schaefer_2018/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz
    2023-03-14 15:27:27,155 - JUNIFER - INFO - No storage specified, returning dictionary




.. GENERATED FROM PYTHON SOURCE LINES 55-56

Check the results

.. GENERATED FROM PYTHON SOURCE LINES 56-62

.. code-block:: default


    print(out.keys())
    print(out["VBM_GM"]["data"].shape)  # Shape is (1 x parcels)

    print(out.keys())
    print(out["BOLD"]["data"].shape)  # Shape is (timepoints x parcels)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    dict_keys(['BOLD', 'VBM_GM'])
    (1, 100)
    dict_keys(['BOLD', 'VBM_GM'])
    (96, 100)





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 4 minutes  33.043 seconds)


.. _sphx_glr_download_auto_examples_run_compute_parcel_mean.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: run_compute_parcel_mean.py <run_compute_parcel_mean.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: run_compute_parcel_mean.ipynb <run_compute_parcel_mean.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
