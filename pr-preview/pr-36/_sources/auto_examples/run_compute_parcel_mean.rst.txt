
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/run_compute_parcel_mean.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_run_compute_parcel_mean.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_run_compute_parcel_mean.py:


Computer Parcel Aggregation.
============================

This example uses a ParcelAggregation marker to compute the mean of each parcel
using the Schaefer parcellations (100 rois, 7 Yeo networks) for both a 3D and
4D nifti

Authors: Federico Raimondo

License: BSD 3 clause

.. GENERATED FROM PYTHON SOURCE LINES 13-20

.. code-block:: default


    import nilearn

    from junifer.markers.parcel_aggregation import ParcelAggregation
    from junifer.utils import configure_logging









.. GENERATED FROM PYTHON SOURCE LINES 21-22

Set the logging level to info to see extra information

.. GENERATED FROM PYTHON SOURCE LINES 22-25

.. code-block:: default

    configure_logging(level="INFO")






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2022-12-02 09:53:53,748 - JUNIFER - INFO - ===== Lib Versions =====
    2022-12-02 09:53:53,748 - JUNIFER - INFO - numpy: 1.23.5
    2022-12-02 09:53:53,748 - JUNIFER - INFO - scipy: 1.9.3
    2022-12-02 09:53:53,748 - JUNIFER - INFO - pandas: 1.5.2
    2022-12-02 09:53:53,748 - JUNIFER - INFO - nilearn: 0.9.2
    2022-12-02 09:53:53,748 - JUNIFER - INFO - nibabel: 4.0.2
    2022-12-02 09:53:53,749 - JUNIFER - INFO - junifer: 0.1.dev1
    2022-12-02 09:53:53,749 - JUNIFER - INFO - ========================




.. GENERATED FROM PYTHON SOURCE LINES 26-28

Load the VBM GM data (3d):
- Fetch the Oasis dataset

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: default

    oasis_dataset = nilearn.datasets.fetch_oasis_vbm(n_subjects=1)
    vbm_fname = oasis_dataset.gray_matter_maps[0]
    vbm_img = nilearn.image.load_img(vbm_fname)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Dataset created in /home/runner/nilearn_data/oasis1

    Downloading data from https://www.nitrc.org/frs/download.php/6364/archive_dartel.tgz ...
    Downloaded 47931392 of 905208634 bytes (5.3%,   18.1s remaining)    Downloaded 114188288 of 905208634 bytes (12.6%,   14.1s remaining)    Downloaded 135995392 of 905208634 bytes (15.0%,   17.9s remaining)    Downloaded 137568256 of 905208634 bytes (15.2%,   23.7s remaining)    Downloaded 138878976 of 905208634 bytes (15.3%,   29.5s remaining)    Downloaded 140107776 of 905208634 bytes (15.5%,   35.0s remaining)    Downloaded 141336576 of 905208634 bytes (15.6%,   40.7s remaining)    Downloaded 142639104 of 905208634 bytes (15.8%,   45.9s remaining)    Downloaded 143638528 of 905208634 bytes (15.9%,   51.3s remaining)    Downloaded 145211392 of 905208634 bytes (16.0%,   56.5s remaining)    Downloaded 146915328 of 905208634 bytes (16.2%,  1.0min remaining)    Downloaded 148488192 of 905208634 bytes (16.4%,  1.1min remaining)    Downloaded 149610496 of 905208634 bytes (16.5%,  1.2min remaining)    Downloaded 151314432 of 905208634 bytes (16.7%,  1.2min remaining)    Downloaded 152363008 of 905208634 bytes (16.8%,  1.3min remaining)    Downloaded 154189824 of 905208634 bytes (17.0%,  1.4min remaining)    Downloaded 155901952 of 905208634 bytes (17.2%,  1.5min remaining)    Downloaded 157106176 of 905208634 bytes (17.4%,  1.5min remaining)    Downloaded 158392320 of 905208634 bytes (17.5%,  1.6min remaining)    Downloaded 159621120 of 905208634 bytes (17.6%,  1.7min remaining)    Downloaded 160694272 of 905208634 bytes (17.8%,  1.7min remaining)    Downloaded 161538048 of 905208634 bytes (17.8%,  1.8min remaining)    Downloaded 162693120 of 905208634 bytes (18.0%,  1.9min remaining)    Downloaded 164552704 of 905208634 bytes (18.2%,  1.9min remaining)    Downloaded 165715968 of 905208634 bytes (18.3%,  2.0min remaining)    Downloaded 166871040 of 905208634 bytes (18.4%,  2.1min remaining)    Downloaded 168124416 of 905208634 bytes (18.6%,  2.1min remaining)    Downloaded 169500672 of 905208634 bytes (18.7%,  2.2min remaining)    Downloaded 170631168 of 905208634 bytes (18.8%,  2.2min remaining)    Downloaded 171589632 of 905208634 bytes (19.0%,  2.3min remaining)    Downloaded 172572672 of 905208634 bytes (19.1%,  2.4min remaining)    Downloaded 173924352 of 905208634 bytes (19.2%,  2.4min remaining)    Downloaded 175226880 of 905208634 bytes (19.4%,  2.5min remaining)    Downloaded 176799744 of 905208634 bytes (19.5%,  2.5min remaining)    Downloaded 178053120 of 905208634 bytes (19.7%,  2.6min remaining)    Downloaded 179109888 of 905208634 bytes (19.8%,  2.6min remaining)    Downloaded 180068352 of 905208634 bytes (19.9%,  2.7min remaining)    Downloaded 181436416 of 905208634 bytes (20.0%,  2.7min remaining)    Downloaded 183009280 of 905208634 bytes (20.2%,  2.8min remaining)    Downloaded 185106432 of 905208634 bytes (20.4%,  2.8min remaining)    Downloaded 187072512 of 905208634 bytes (20.7%,  2.8min remaining)    Downloaded 188375040 of 905208634 bytes (20.8%,  2.9min remaining)    Downloaded 189898752 of 905208634 bytes (21.0%,  2.9min remaining)    Downloaded 191348736 of 905208634 bytes (21.1%,  3.0min remaining)    Downloaded 193044480 of 905208634 bytes (21.3%,  3.0min remaining)    Downloaded 194560000 of 905208634 bytes (21.5%,  3.0min remaining)    Downloaded 196132864 of 905208634 bytes (21.7%,  3.1min remaining)    Downloaded 197443584 of 905208634 bytes (21.8%,  3.1min remaining)    Downloaded 199278592 of 905208634 bytes (22.0%,  3.1min remaining)    Downloaded 200458240 of 905208634 bytes (22.1%,  3.2min remaining)    Downloaded 201621504 of 905208634 bytes (22.3%,  3.2min remaining)    Downloaded 203063296 of 905208634 bytes (22.4%,  3.2min remaining)    Downloaded 204316672 of 905208634 bytes (22.6%,  3.3min remaining)    Downloaded 205848576 of 905208634 bytes (22.7%,  3.3min remaining)    Downloaded 206880768 of 905208634 bytes (22.9%,  3.3min remaining)    Downloaded 208281600 of 905208634 bytes (23.0%,  3.4min remaining)    Downloaded 209207296 of 905208634 bytes (23.1%,  3.4min remaining)    Downloaded 210911232 of 905208634 bytes (23.3%,  3.4min remaining)    Downloaded 212746240 of 905208634 bytes (23.5%,  3.4min remaining)    Downloaded 213467136 of 905208634 bytes (23.6%,  3.5min remaining)    Downloaded 214474752 of 905208634 bytes (23.7%,  3.5min remaining)    Downloaded 215138304 of 905208634 bytes (23.8%,  3.6min remaining)    Downloaded 216293376 of 905208634 bytes (23.9%,  3.6min remaining)    Downloaded 217866240 of 905208634 bytes (24.1%,  3.6min remaining)    Downloaded 218963968 of 905208634 bytes (24.2%,  3.6min remaining)    Downloaded 220790784 of 905208634 bytes (24.4%,  3.7min remaining)    Downloaded 222363648 of 905208634 bytes (24.6%,  3.7min remaining)    Downloaded 223592448 of 905208634 bytes (24.7%,  3.7min remaining)    Downloaded 224763904 of 905208634 bytes (24.8%,  3.7min remaining)    Downloaded 225681408 of 905208634 bytes (24.9%,  3.8min remaining)    Downloaded 227377152 of 905208634 bytes (25.1%,  3.8min remaining)    Downloaded 228556800 of 905208634 bytes (25.2%,  3.8min remaining)    Downloaded 230129664 of 905208634 bytes (25.4%,  3.8min remaining)    Downloaded 231186432 of 905208634 bytes (25.5%,  3.8min remaining)    Downloaded 232284160 of 905208634 bytes (25.7%,  3.9min remaining)    Downloaded 233963520 of 905208634 bytes (25.8%,  3.9min remaining)    Downloaded 235929600 of 905208634 bytes (26.1%,  3.9min remaining)    Downloaded 237895680 of 905208634 bytes (26.3%,  3.9min remaining)    Downloaded 239468544 of 905208634 bytes (26.5%,  3.9min remaining)    Downloaded 240918528 of 905208634 bytes (26.6%,  3.9min remaining)    Downloaded 242491392 of 905208634 bytes (26.8%,  3.9min remaining)    Downloaded 244064256 of 905208634 bytes (27.0%,  4.0min remaining)    Downloaded 246153216 of 905208634 bytes (27.2%,  4.0min remaining)    Downloaded 248119296 of 905208634 bytes (27.4%,  4.0min remaining)    Downloaded 249831424 of 905208634 bytes (27.6%,  4.0min remaining)    Downloaded 251265024 of 905208634 bytes (27.8%,  4.0min remaining)    Downloaded 252100608 of 905208634 bytes (27.9%,  4.0min remaining)    Downloaded 254066688 of 905208634 bytes (28.1%,  4.0min remaining)    Downloaded 256032768 of 905208634 bytes (28.3%,  4.0min remaining)    Downloaded 257089536 of 905208634 bytes (28.4%,  4.0min remaining)    Downloaded 258514944 of 905208634 bytes (28.6%,  4.1min remaining)    Downloaded 259940352 of 905208634 bytes (28.7%,  4.1min remaining)    Downloaded 261906432 of 905208634 bytes (28.9%,  4.1min remaining)    Downloaded 263741440 of 905208634 bytes (29.1%,  4.1min remaining)    Downloaded 265003008 of 905208634 bytes (29.3%,  4.1min remaining)    Downloaded 266936320 of 905208634 bytes (29.5%,  4.1min remaining)    Downloaded 267796480 of 905208634 bytes (29.6%,  4.1min remaining)    Downloaded 269328384 of 905208634 bytes (29.8%,  4.1min remaining)    Downloaded 270385152 of 905208634 bytes (29.9%,  4.1min remaining)    Downloaded 271826944 of 905208634 bytes (30.0%,  4.2min remaining)    Downloaded 273260544 of 905208634 bytes (30.2%,  4.2min remaining)    Downloaded 274464768 of 905208634 bytes (30.3%,  4.2min remaining)    Downloaded 276176896 of 905208634 bytes (30.5%,  4.2min remaining)    Downloaded 277512192 of 905208634 bytes (30.7%,  4.2min remaining)    Downloaded 279207936 of 905208634 bytes (30.8%,  4.2min remaining)    Downloaded 280526848 of 905208634 bytes (31.0%,  4.2min remaining)    Downloaded 281690112 of 905208634 bytes (31.1%,  4.2min remaining)    Downloaded 283238400 of 905208634 bytes (31.3%,  4.2min remaining)    Downloaded 284737536 of 905208634 bytes (31.5%,  4.2min remaining)    Downloaded 286162944 of 905208634 bytes (31.6%,  4.2min remaining)    Downloaded 287612928 of 905208634 bytes (31.8%,  4.2min remaining)    Downloaded 289161216 of 905208634 bytes (31.9%,  4.3min remaining)    Downloaded 289865728 of 905208634 bytes (32.0%,  4.3min remaining)    Downloaded 292306944 of 905208634 bytes (32.3%,  4.3min remaining)    Downloaded 293756928 of 905208634 bytes (32.5%,  4.3min remaining)    Downloaded 295084032 of 905208634 bytes (32.6%,  4.3min remaining)    Downloaded 296509440 of 905208634 bytes (32.8%,  4.3min remaining)    Downloaded 297959424 of 905208634 bytes (32.9%,  4.3min remaining)    Downloaded 299655168 of 905208634 bytes (33.1%,  4.3min remaining)    Downloaded 301228032 of 905208634 bytes (33.3%,  4.3min remaining)    Downloaded 303194112 of 905208634 bytes (33.5%,  4.3min remaining)    Downloaded 305299456 of 905208634 bytes (33.7%,  4.3min remaining)    Downloaded 306659328 of 905208634 bytes (33.9%,  4.3min remaining)    Downloaded 307388416 of 905208634 bytes (34.0%,  4.3min remaining)    Downloaded 308330496 of 905208634 bytes (34.1%,  4.3min remaining)    Downloaded 309600256 of 905208634 bytes (34.2%,  4.3min remaining)    Downloaded 310788096 of 905208634 bytes (34.3%,  4.3min remaining)    Downloaded 311959552 of 905208634 bytes (34.5%,  4.3min remaining)    Downloaded 313786368 of 905208634 bytes (34.7%,  4.3min remaining)    Downloaded 315105280 of 905208634 bytes (34.8%,  4.3min remaining)    Downloaded 316186624 of 905208634 bytes (34.9%,  4.3min remaining)    Downloaded 316882944 of 905208634 bytes (35.0%,  4.4min remaining)    Downloaded 317964288 of 905208634 bytes (35.1%,  4.4min remaining)    Downloaded 319184896 of 905208634 bytes (35.3%,  4.4min remaining)    Downloaded 319823872 of 905208634 bytes (35.3%,  4.4min remaining)    Downloaded 320987136 of 905208634 bytes (35.5%,  4.4min remaining)    Downloaded 322043904 of 905208634 bytes (35.6%,  4.4min remaining)    Downloaded 323739648 of 905208634 bytes (35.8%,  4.4min remaining)    Downloaded 325181440 of 905208634 bytes (35.9%,  4.4min remaining)    Downloaded 327278592 of 905208634 bytes (36.2%,  4.4min remaining)    Downloaded 328728576 of 905208634 bytes (36.3%,  4.4min remaining)    Downloaded 329932800 of 905208634 bytes (36.4%,  4.4min remaining)    Downloaded 332161024 of 905208634 bytes (36.7%,  4.4min remaining)    Downloaded 334258176 of 905208634 bytes (36.9%,  4.4min remaining)    Downloaded 335699968 of 905208634 bytes (37.1%,  4.4min remaining)    Downloaded 337666048 of 905208634 bytes (37.3%,  4.4min remaining)    Downloaded 339640320 of 905208634 bytes (37.5%,  4.4min remaining)    Downloaded 340992000 of 905208634 bytes (37.7%,  4.4min remaining)    Downloaded 342827008 of 905208634 bytes (37.9%,  4.3min remaining)    Downloaded 344547328 of 905208634 bytes (38.1%,  4.3min remaining)    Downloaded 345972736 of 905208634 bytes (38.2%,  4.3min remaining)    Downloaded 347799552 of 905208634 bytes (38.4%,  4.3min remaining)    Downloaded 348831744 of 905208634 bytes (38.5%,  4.3min remaining)    Downloaded 350797824 of 905208634 bytes (38.8%,  4.3min remaining)    Downloaded 352190464 of 905208634 bytes (38.9%,  4.3min remaining)    Downloaded 353107968 of 905208634 bytes (39.0%,  4.3min remaining)    Downloaded 354091008 of 905208634 bytes (39.1%,  4.3min remaining)    Downloaded 355557376 of 905208634 bytes (39.3%,  4.3min remaining)    Downloaded 356646912 of 905208634 bytes (39.4%,  4.4min remaining)    Downloaded 358383616 of 905208634 bytes (39.6%,  4.3min remaining)    Downloaded 359645184 of 905208634 bytes (39.7%,  4.3min remaining)    Downloaded 360620032 of 905208634 bytes (39.8%,  4.4min remaining)    Downloaded 362192896 of 905208634 bytes (40.0%,  4.4min remaining)    Downloaded 362938368 of 905208634 bytes (40.1%,  4.4min remaining)    Downloaded 364388352 of 905208634 bytes (40.3%,  4.4min remaining)    Downloaded 365936640 of 905208634 bytes (40.4%,  4.4min remaining)    Downloaded 368041984 of 905208634 bytes (40.7%,  4.3min remaining)    Downloaded 369156096 of 905208634 bytes (40.8%,  4.3min remaining)    Downloaded 370311168 of 905208634 bytes (40.9%,  4.3min remaining)    Downloaded 371982336 of 905208634 bytes (41.1%,  4.3min remaining)    Downloaded 373694464 of 905208634 bytes (41.3%,  4.3min remaining)    Downloaded 375914496 of 905208634 bytes (41.5%,  4.3min remaining)    Downloaded 378544128 of 905208634 bytes (41.8%,  4.3min remaining)    Downloaded 380624896 of 905208634 bytes (42.0%,  4.3min remaining)    Downloaded 382451712 of 905208634 bytes (42.3%,  4.3min remaining)    Downloaded 384163840 of 905208634 bytes (42.4%,  4.2min remaining)    Downloaded 385736704 of 905208634 bytes (42.6%,  4.2min remaining)    Downloaded 386547712 of 905208634 bytes (42.7%,  4.2min remaining)    Downloaded 387579904 of 905208634 bytes (42.8%,  4.3min remaining)    Downloaded 389799936 of 905208634 bytes (43.1%,  4.2min remaining)    Downloaded 391364608 of 905208634 bytes (43.2%,  4.2min remaining)    Downloaded 392937472 of 905208634 bytes (43.4%,  4.2min remaining)    Downloaded 394903552 of 905208634 bytes (43.6%,  4.2min remaining)    Downloaded 396607488 of 905208634 bytes (43.8%,  4.2min remaining)    Downloaded 397950976 of 905208634 bytes (44.0%,  4.2min remaining)    Downloaded 400048128 of 905208634 bytes (44.2%,  4.2min remaining)    Downloaded 402137088 of 905208634 bytes (44.4%,  4.2min remaining)    Downloaded 403439616 of 905208634 bytes (44.6%,  4.2min remaining)    Downloaded 405274624 of 905208634 bytes (44.8%,  4.1min remaining)    Downloaded 406585344 of 905208634 bytes (44.9%,  4.1min remaining)    Downloaded 407805952 of 905208634 bytes (45.1%,  4.1min remaining)    Downloaded 408723456 of 905208634 bytes (45.2%,  4.1min remaining)    Downloaded 410075136 of 905208634 bytes (45.3%,  4.1min remaining)    Downloaded 411918336 of 905208634 bytes (45.5%,  4.1min remaining)    Downloaded 413638656 of 905208634 bytes (45.7%,  4.1min remaining)    Downloaded 415866880 of 905208634 bytes (45.9%,  4.1min remaining)    Downloaded 417570816 of 905208634 bytes (46.1%,  4.1min remaining)    Downloaded 419438592 of 905208634 bytes (46.3%,  4.1min remaining)    Downloaded 421036032 of 905208634 bytes (46.5%,  4.1min remaining)    Downloaded 423395328 of 905208634 bytes (46.8%,  4.0min remaining)    Downloaded 424845312 of 905208634 bytes (46.9%,  4.0min remaining)    Downloaded 426811392 of 905208634 bytes (47.2%,  4.0min remaining)    Downloaded 428457984 of 905208634 bytes (47.3%,  4.0min remaining)    Downloaded 430022656 of 905208634 bytes (47.5%,  4.0min remaining)    Downloaded 431538176 of 905208634 bytes (47.7%,  4.0min remaining)    Downloaded 433242112 of 905208634 bytes (47.9%,  4.0min remaining)    Downloaded 434470912 of 905208634 bytes (48.0%,  4.0min remaining)    Downloaded 436568064 of 905208634 bytes (48.2%,  4.0min remaining)    Downloaded 438034432 of 905208634 bytes (48.4%,  4.0min remaining)    Downloaded 439164928 of 905208634 bytes (48.5%,  4.0min remaining)    Downloaded 441114624 of 905208634 bytes (48.7%,  3.9min remaining)    Downloaded 442957824 of 905208634 bytes (48.9%,  3.9min remaining)    Downloaded 444334080 of 905208634 bytes (49.1%,  3.9min remaining)    Downloaded 445530112 of 905208634 bytes (49.2%,  3.9min remaining)    Downloaded 446595072 of 905208634 bytes (49.3%,  3.9min remaining)    Downloaded 447676416 of 905208634 bytes (49.5%,  3.9min remaining)    Downloaded 448757760 of 905208634 bytes (49.6%,  3.9min remaining)    Downloaded 450961408 of 905208634 bytes (49.8%,  3.9min remaining)    Downloaded 452534272 of 905208634 bytes (50.0%,  3.9min remaining)    Downloaded 453648384 of 905208634 bytes (50.1%,  3.9min remaining)    Downloaded 455122944 of 905208634 bytes (50.3%,  3.9min remaining)    Downloaded 456957952 of 905208634 bytes (50.5%,  3.9min remaining)    Downloaded 457949184 of 905208634 bytes (50.6%,  3.9min remaining)    Downloaded 459128832 of 905208634 bytes (50.7%,  3.9min remaining)    Downloaded 460431360 of 905208634 bytes (50.9%,  3.9min remaining)    Downloaded 461750272 of 905208634 bytes (51.0%,  3.9min remaining)    Downloaded 463323136 of 905208634 bytes (51.2%,  3.8min remaining)    Downloaded 464781312 of 905208634 bytes (51.3%,  3.8min remaining)    Downloaded 466231296 of 905208634 bytes (51.5%,  3.8min remaining)    Downloaded 468336640 of 905208634 bytes (51.7%,  3.8min remaining)    Downloaded 470040576 of 905208634 bytes (51.9%,  3.8min remaining)    Downloaded 471638016 of 905208634 bytes (52.1%,  3.8min remaining)    Downloaded 473309184 of 905208634 bytes (52.3%,  3.8min remaining)    Downloaded 474849280 of 905208634 bytes (52.5%,  3.8min remaining)    Downloaded 476823552 of 905208634 bytes (52.7%,  3.7min remaining)    Downloaded 477798400 of 905208634 bytes (52.8%,  3.7min remaining)    Downloaded 479748096 of 905208634 bytes (53.0%,  3.7min remaining)    Downloaded 481714176 of 905208634 bytes (53.2%,  3.7min remaining)    Downloaded 483237888 of 905208634 bytes (53.4%,  3.7min remaining)    Downloaded 485072896 of 905208634 bytes (53.6%,  3.7min remaining)    Downloaded 487292928 of 905208634 bytes (53.8%,  3.7min remaining)    Downloaded 489398272 of 905208634 bytes (54.1%,  3.6min remaining)    Downloaded 490708992 of 905208634 bytes (54.2%,  3.6min remaining)    Downloaded 492675072 of 905208634 bytes (54.4%,  3.6min remaining)    Downloaded 494641152 of 905208634 bytes (54.6%,  3.6min remaining)    Downloaded 496476160 of 905208634 bytes (54.8%,  3.6min remaining)    Downloaded 498573312 of 905208634 bytes (55.1%,  3.6min remaining)    Downloaded 500391936 of 905208634 bytes (55.3%,  3.6min remaining)    Downloaded 502480896 of 905208634 bytes (55.5%,  3.5min remaining)    Downloaded 504586240 of 905208634 bytes (55.7%,  3.5min remaining)    Downloaded 506413056 of 905208634 bytes (55.9%,  3.5min remaining)    Downloaded 508256256 of 905208634 bytes (56.1%,  3.5min remaining)    Downloaded 510484480 of 905208634 bytes (56.4%,  3.5min remaining)    Downloaded 512040960 of 905208634 bytes (56.6%,  3.5min remaining)    Downloaded 514400256 of 905208634 bytes (56.8%,  3.4min remaining)    Downloaded 516636672 of 905208634 bytes (57.1%,  3.4min remaining)    Downloaded 518594560 of 905208634 bytes (57.3%,  3.4min remaining)    Downloaded 520421376 of 905208634 bytes (57.5%,  3.4min remaining)    Downloaded 521994240 of 905208634 bytes (57.7%,  3.4min remaining)    Downloaded 523419648 of 905208634 bytes (57.8%,  3.4min remaining)    Downloaded 525025280 of 905208634 bytes (58.0%,  3.4min remaining)    Downloaded 526139392 of 905208634 bytes (58.1%,  3.3min remaining)    Downloaded 528015360 of 905208634 bytes (58.3%,  3.3min remaining)    Downloaded 529981440 of 905208634 bytes (58.5%,  3.3min remaining)    Downloaded 531161088 of 905208634 bytes (58.7%,  3.3min remaining)    Downloaded 532635648 of 905208634 bytes (58.8%,  3.3min remaining)    Downloaded 534282240 of 905208634 bytes (59.0%,  3.3min remaining)    Downloaded 536641536 of 905208634 bytes (59.3%,  3.3min remaining)    Downloaded 538083328 of 905208634 bytes (59.4%,  3.3min remaining)    Downloaded 539222016 of 905208634 bytes (59.6%,  3.2min remaining)    Downloaded 540524544 of 905208634 bytes (59.7%,  3.2min remaining)    Downloaded 542466048 of 905208634 bytes (59.9%,  3.2min remaining)    Downloaded 544235520 of 905208634 bytes (60.1%,  3.2min remaining)    Downloaded 545980416 of 905208634 bytes (60.3%,  3.2min remaining)    Downloaded 547299328 of 905208634 bytes (60.5%,  3.2min remaining)    Downloaded 549396480 of 905208634 bytes (60.7%,  3.2min remaining)    Downloaded 551231488 of 905208634 bytes (60.9%,  3.2min remaining)    Downloaded 552460288 of 905208634 bytes (61.0%,  3.1min remaining)    Downloaded 553771008 of 905208634 bytes (61.2%,  3.1min remaining)    Downloaded 555237376 of 905208634 bytes (61.3%,  3.1min remaining)    Downloaded 556572672 of 905208634 bytes (61.5%,  3.1min remaining)    Downloaded 558555136 of 905208634 bytes (61.7%,  3.1min remaining)    Downloaded 559939584 of 905208634 bytes (61.9%,  3.1min remaining)    Downloaded 562044928 of 905208634 bytes (62.1%,  3.1min remaining)    Downloaded 564142080 of 905208634 bytes (62.3%,  3.1min remaining)    Downloaded 565714944 of 905208634 bytes (62.5%,  3.0min remaining)    Downloaded 567549952 of 905208634 bytes (62.7%,  3.0min remaining)    Downloaded 568614912 of 905208634 bytes (62.8%,  3.0min remaining)    Downloaded 569810944 of 905208634 bytes (62.9%,  3.0min remaining)    Downloaded 571432960 of 905208634 bytes (63.1%,  3.0min remaining)    Downloaded 573530112 of 905208634 bytes (63.4%,  3.0min remaining)    Downloaded 575225856 of 905208634 bytes (63.5%,  3.0min remaining)    Downloaded 576798720 of 905208634 bytes (63.7%,  3.0min remaining)    Downloaded 579158016 of 905208634 bytes (64.0%,  2.9min remaining)    Downloaded 581148672 of 905208634 bytes (64.2%,  2.9min remaining)    Downloaded 582402048 of 905208634 bytes (64.3%,  2.9min remaining)    Downloaded 584368128 of 905208634 bytes (64.6%,  2.9min remaining)    Downloaded 586113024 of 905208634 bytes (64.7%,  2.9min remaining)    Downloaded 588054528 of 905208634 bytes (65.0%,  2.9min remaining)    Downloaded 589234176 of 905208634 bytes (65.1%,  2.8min remaining)    Downloaded 590946304 of 905208634 bytes (65.3%,  2.8min remaining)    Downloaded 593166336 of 905208634 bytes (65.5%,  2.8min remaining)    Downloaded 595402752 of 905208634 bytes (65.8%,  2.8min remaining)    Downloaded 597000192 of 905208634 bytes (66.0%,  2.8min remaining)    Downloaded 598966272 of 905208634 bytes (66.2%,  2.8min remaining)    Downloaded 600686592 of 905208634 bytes (66.4%,  2.7min remaining)    Downloaded 602644480 of 905208634 bytes (66.6%,  2.7min remaining)    Downloaded 604741632 of 905208634 bytes (66.8%,  2.7min remaining)    Downloaded 606560256 of 905208634 bytes (67.0%,  2.7min remaining)    Downloaded 607887360 of 905208634 bytes (67.2%,  2.7min remaining)    Downloaded 609968128 of 905208634 bytes (67.4%,  2.7min remaining)    Downloaded 612065280 of 905208634 bytes (67.6%,  2.6min remaining)    Downloaded 614277120 of 905208634 bytes (67.9%,  2.6min remaining)    Downloaded 616259584 of 905208634 bytes (68.1%,  2.6min remaining)    Downloaded 617930752 of 905208634 bytes (68.3%,  2.6min remaining)    Downloaded 619503616 of 905208634 bytes (68.4%,  2.6min remaining)    Downloaded 621576192 of 905208634 bytes (68.7%,  2.6min remaining)    Downloaded 622944256 of 905208634 bytes (68.8%,  2.6min remaining)    Downloaded 625041408 of 905208634 bytes (69.0%,  2.5min remaining)    Downloaded 627523584 of 905208634 bytes (69.3%,  2.5min remaining)    Downloaded 628973568 of 905208634 bytes (69.5%,  2.5min remaining)    Downloaded 629727232 of 905208634 bytes (69.6%,  2.5min remaining)    Downloaded 631963648 of 905208634 bytes (69.8%,  2.5min remaining)    Downloaded 633839616 of 905208634 bytes (70.0%,  2.5min remaining)    Downloaded 634839040 of 905208634 bytes (70.1%,  2.4min remaining)    Downloaded 636665856 of 905208634 bytes (70.3%,  2.4min remaining)    Downloaded 638771200 of 905208634 bytes (70.6%,  2.4min remaining)    Downloaded 641261568 of 905208634 bytes (70.8%,  2.4min remaining)    Downloaded 642981888 of 905208634 bytes (71.0%,  2.4min remaining)    Downloaded 644800512 of 905208634 bytes (71.2%,  2.4min remaining)    Downloaded 646635520 of 905208634 bytes (71.4%,  2.3min remaining)    Downloaded 648462336 of 905208634 bytes (71.6%,  2.3min remaining)    Downloaded 650452992 of 905208634 bytes (71.9%,  2.3min remaining)    Downloaded 651509760 of 905208634 bytes (72.0%,  2.3min remaining)    Downloaded 653746176 of 905208634 bytes (72.2%,  2.3min remaining)    Downloaded 655835136 of 905208634 bytes (72.5%,  2.3min remaining)    Downloaded 657940480 of 905208634 bytes (72.7%,  2.2min remaining)    Downloaded 659644416 of 905208634 bytes (72.9%,  2.2min remaining)    Downloaded 661610496 of 905208634 bytes (73.1%,  2.2min remaining)    Downloaded 663429120 of 905208634 bytes (73.3%,  2.2min remaining)    Downloaded 665518080 of 905208634 bytes (73.5%,  2.2min remaining)    Downloaded 667230208 of 905208634 bytes (73.7%,  2.2min remaining)    Downloaded 668565504 of 905208634 bytes (73.9%,  2.1min remaining)    Downloaded 670531584 of 905208634 bytes (74.1%,  2.1min remaining)    Downloaded 672104448 of 905208634 bytes (74.2%,  2.1min remaining)    Downloaded 673677312 of 905208634 bytes (74.4%,  2.1min remaining)    Downloaded 674873344 of 905208634 bytes (74.6%,  2.1min remaining)    Downloaded 676405248 of 905208634 bytes (74.7%,  2.1min remaining)    Downloaded 678150144 of 905208634 bytes (74.9%,  2.1min remaining)    Downloaded 679772160 of 905208634 bytes (75.1%,  2.1min remaining)    Downloaded 681639936 of 905208634 bytes (75.3%,  2.0min remaining)    Downloaded 683425792 of 905208634 bytes (75.5%,  2.0min remaining)    Downloaded 684613632 of 905208634 bytes (75.6%,  2.0min remaining)    Downloaded 686358528 of 905208634 bytes (75.8%,  2.0min remaining)    Downloaded 687808512 of 905208634 bytes (76.0%,  2.0min remaining)    Downloaded 689053696 of 905208634 bytes (76.1%,  2.0min remaining)    Downloaded 690020352 of 905208634 bytes (76.2%,  2.0min remaining)    Downloaded 692379648 of 905208634 bytes (76.5%,  1.9min remaining)    Downloaded 694607872 of 905208634 bytes (76.7%,  1.9min remaining)    Downloaded 696967168 of 905208634 bytes (77.0%,  1.9min remaining)    Downloaded 699064320 of 905208634 bytes (77.2%,  1.9min remaining)    Downloaded 700637184 of 905208634 bytes (77.4%,  1.9min remaining)    Downloaded 702210048 of 905208634 bytes (77.6%,  1.9min remaining)    Downloaded 704438272 of 905208634 bytes (77.8%,  1.8min remaining)    Downloaded 706387968 of 905208634 bytes (78.0%,  1.8min remaining)    Downloaded 707543040 of 905208634 bytes (78.2%,  1.8min remaining)    Downloaded 709165056 of 905208634 bytes (78.3%,  1.8min remaining)    Downloaded 711008256 of 905208634 bytes (78.5%,  1.8min remaining)    Downloaded 712556544 of 905208634 bytes (78.7%,  1.8min remaining)    Downloaded 714104832 of 905208634 bytes (78.9%,  1.8min remaining)    Downloaded 715309056 of 905208634 bytes (79.0%,  1.7min remaining)    Downloaded 717152256 of 905208634 bytes (79.2%,  1.7min remaining)    Downloaded 718839808 of 905208634 bytes (79.4%,  1.7min remaining)    Downloaded 720019456 of 905208634 bytes (79.5%,  1.7min remaining)    Downloaded 722214912 of 905208634 bytes (79.8%,  1.7min remaining)    Downloaded 724303872 of 905208634 bytes (80.0%,  1.7min remaining)    Downloaded 726269952 of 905208634 bytes (80.2%,  1.6min remaining)    Downloaded 728629248 of 905208634 bytes (80.5%,  1.6min remaining)    Downloaded 730341376 of 905208634 bytes (80.7%,  1.6min remaining)    Downloaded 732168192 of 905208634 bytes (80.9%,  1.6min remaining)    Downloaded 734273536 of 905208634 bytes (81.1%,  1.6min remaining)    Downloaded 735510528 of 905208634 bytes (81.3%,  1.6min remaining)    Downloaded 736886784 of 905208634 bytes (81.4%,  1.5min remaining)    Downloaded 738992128 of 905208634 bytes (81.6%,  1.5min remaining)    Downloaded 740712448 of 905208634 bytes (81.8%,  1.5min remaining)    Downloaded 742662144 of 905208634 bytes (82.0%,  1.5min remaining)    Downloaded 743989248 of 905208634 bytes (82.2%,  1.5min remaining)    Downloaded 745930752 of 905208634 bytes (82.4%,  1.5min remaining)    Downloaded 747888640 of 905208634 bytes (82.6%,  1.4min remaining)    Downloaded 750247936 of 905208634 bytes (82.9%,  1.4min remaining)    Downloaded 752607232 of 905208634 bytes (83.1%,  1.4min remaining)    Downloaded 754114560 of 905208634 bytes (83.3%,  1.4min remaining)    Downloaded 755589120 of 905208634 bytes (83.5%,  1.4min remaining)    Downloaded 757530624 of 905208634 bytes (83.7%,  1.4min remaining)    Downloaded 759889920 of 905208634 bytes (83.9%,  1.3min remaining)    Downloaded 762249216 of 905208634 bytes (84.2%,  1.3min remaining)    Downloaded 764755968 of 905208634 bytes (84.5%,  1.3min remaining)    Downloaded 766058496 of 905208634 bytes (84.6%,  1.3min remaining)    Downloaded 767410176 of 905208634 bytes (84.8%,  1.3min remaining)    Downloaded 768835584 of 905208634 bytes (84.9%,  1.3min remaining)    Downloaded 770801664 of 905208634 bytes (85.2%,  1.2min remaining)    Downloaded 772890624 of 905208634 bytes (85.4%,  1.2min remaining)    Downloaded 774733824 of 905208634 bytes (85.6%,  1.2min remaining)    Downloaded 777093120 of 905208634 bytes (85.8%,  1.2min remaining)    Downloaded 779321344 of 905208634 bytes (86.1%,  1.2min remaining)    Downloaded 781811712 of 905208634 bytes (86.4%,  1.1min remaining)    Downloaded 783646720 of 905208634 bytes (86.6%,  1.1min remaining)    Downloaded 785743872 of 905208634 bytes (86.8%,  1.1min remaining)    Downloaded 787365888 of 905208634 bytes (87.0%,  1.1min remaining)    Downloaded 789446656 of 905208634 bytes (87.2%,  1.1min remaining)    Downloaded 791543808 of 905208634 bytes (87.4%,  1.0min remaining)    Downloaded 793509888 of 905208634 bytes (87.7%,  1.0min remaining)    Downloaded 795082752 of 905208634 bytes (87.8%,  1.0min remaining)    Downloaded 797048832 of 905208634 bytes (88.1%,   59.7s remaining)    Downloaded 799531008 of 905208634 bytes (88.3%,   58.3s remaining)    Downloaded 802160640 of 905208634 bytes (88.6%,   56.8s remaining)    Downloaded 803856384 of 905208634 bytes (88.8%,   55.9s remaining)    Downloaded 805822464 of 905208634 bytes (89.0%,   54.8s remaining)    Downloaded 807927808 of 905208634 bytes (89.3%,   53.6s remaining)    Downloaded 809902080 of 905208634 bytes (89.5%,   52.5s remaining)    Downloaded 810778624 of 905208634 bytes (89.6%,   52.1s remaining)    Downloaded 812605440 of 905208634 bytes (89.8%,   51.1s remaining)    Downloaded 814841856 of 905208634 bytes (90.0%,   49.8s remaining)    Downloaded 817078272 of 905208634 bytes (90.3%,   48.6s remaining)    Downloaded 818774016 of 905208634 bytes (90.5%,   47.7s remaining)    Downloaded 820568064 of 905208634 bytes (90.6%,   46.7s remaining)    Downloaded 822534144 of 905208634 bytes (90.9%,   45.6s remaining)    Downloaded 824893440 of 905208634 bytes (91.1%,   44.3s remaining)    Downloaded 826458112 of 905208634 bytes (91.3%,   43.4s remaining)    Downloaded 828817408 of 905208634 bytes (91.6%,   42.1s remaining)    Downloaded 831242240 of 905208634 bytes (91.8%,   40.7s remaining)    Downloaded 833396736 of 905208634 bytes (92.1%,   39.5s remaining)    Downloaded 835502080 of 905208634 bytes (92.3%,   38.4s remaining)    Downloaded 836837376 of 905208634 bytes (92.4%,   37.7s remaining)    Downloaded 838942720 of 905208634 bytes (92.7%,   36.5s remaining)    Downloaded 840908800 of 905208634 bytes (92.9%,   35.4s remaining)    Downloaded 843268096 of 905208634 bytes (93.2%,   34.1s remaining)    Downloaded 845365248 of 905208634 bytes (93.4%,   32.9s remaining)    Downloaded 847724544 of 905208634 bytes (93.6%,   31.6s remaining)    Downloaded 850083840 of 905208634 bytes (93.9%,   30.3s remaining)    Downloaded 852049920 of 905208634 bytes (94.1%,   29.2s remaining)    Downloaded 853745664 of 905208634 bytes (94.3%,   28.3s remaining)    Downloaded 855195648 of 905208634 bytes (94.5%,   27.5s remaining)    Downloaded 857038848 of 905208634 bytes (94.7%,   26.5s remaining)    Downloaded 858464256 of 905208634 bytes (94.8%,   25.7s remaining)    Downloaded 860823552 of 905208634 bytes (95.1%,   24.4s remaining)    Downloaded 863182848 of 905208634 bytes (95.4%,   23.1s remaining)    Downloaded 865542144 of 905208634 bytes (95.6%,   21.8s remaining)    Downloaded 867647488 of 905208634 bytes (95.9%,   20.6s remaining)    Downloaded 869466112 of 905208634 bytes (96.1%,   19.6s remaining)    Downloaded 871825408 of 905208634 bytes (96.3%,   18.3s remaining)    Downloaded 874315776 of 905208634 bytes (96.6%,   16.9s remaining)    Downloaded 876937216 of 905208634 bytes (96.9%,   15.5s remaining)    Downloaded 879149056 of 905208634 bytes (97.1%,   14.3s remaining)    Downloaded 881287168 of 905208634 bytes (97.4%,   13.1s remaining)    Downloaded 882991104 of 905208634 bytes (97.5%,   12.2s remaining)    Downloaded 885071872 of 905208634 bytes (97.8%,   11.0s remaining)    Downloaded 887291904 of 905208634 bytes (98.0%,    9.8s remaining)    Downloaded 889651200 of 905208634 bytes (98.3%,    8.5s remaining)    Downloaded 892149760 of 905208634 bytes (98.6%,    7.1s remaining)    Downloaded 893452288 of 905208634 bytes (98.7%,    6.4s remaining)    Downloaded 895197184 of 905208634 bytes (98.9%,    5.5s remaining)    Downloaded 897024000 of 905208634 bytes (99.1%,    4.5s remaining)    Downloaded 898990080 of 905208634 bytes (99.3%,    3.4s remaining)    Downloaded 901881856 of 905208634 bytes (99.6%,    1.8s remaining)    Downloaded 903708672 of 905208634 bytes (99.8%,    0.8s remaining) ...done. (495 seconds, 8 min)
    Extracting data from /home/runner/nilearn_data/oasis1/6d19418bccb98b1333309bd8baa05152/archive_dartel.tgz..... done.
    /opt/hostedtoolcache/Python/3.10.8/x64/lib/python3.10/site-packages/nilearn/datasets/struct.py:774: UserWarning: `legacy_format` will default to `False` in release 0.11. Dataset fetchers will then return pandas dataframes by default instead of recarrays.
      warnings.warn(_LEGACY_FORMAT_MSG)




.. GENERATED FROM PYTHON SOURCE LINES 33-36

Load the functional data (4d):
- Fetch the SPM auditory dataset
- Concatenate the functional data into one 4D image

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default

    s_func_data = nilearn.datasets.fetch_spm_auditory()
    fmri_img = nilearn.image.concat_imgs(s_func_data.func)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Dataset created in /home/runner/nilearn_data/spm_auditory

    Data absent, downloading...
    Downloading data from http://www.fil.ion.ucl.ac.uk/spm/download/data/MoAEpilot/MoAEpilot.zip ...
    Downloaded 3825664 of 34212021 bytes (11.2%,    8.1s remaining)    Downloaded 8617984 of 34212021 bytes (25.2%,    6.0s remaining)    Downloaded 12976128 of 34212021 bytes (37.9%,    5.0s remaining)    Downloaded 17866752 of 34212021 bytes (52.2%,    3.7s remaining)    Downloaded 21463040 of 34212021 bytes (62.7%,    3.0s remaining)    Downloaded 25165824 of 34212021 bytes (73.6%,    2.2s remaining)    Downloaded 29270016 of 34212021 bytes (85.6%,    1.2s remaining)    Downloaded 33193984 of 34212021 bytes (97.0%,    0.2s remaining) ...done. (10 seconds, 0 min)
    Extracting data from /home/runner/nilearn_data/spm_auditory/sub001/MoAEpilot.zip..... done.




.. GENERATED FROM PYTHON SOURCE LINES 40-41

Define the marker

.. GENERATED FROM PYTHON SOURCE LINES 41-43

.. code-block:: default

    marker = ParcelAggregation(parcellation="Schaefer100x7", method="mean")








.. GENERATED FROM PYTHON SOURCE LINES 44-45

Prepare the input

.. GENERATED FROM PYTHON SOURCE LINES 45-50

.. code-block:: default

    input = {
        "BOLD": {"data": fmri_img, "meta": {"element": "subject1"}},
        "VBM_GM": {"data": vbm_img, "meta": {"element": "subject1"}},
    }








.. GENERATED FROM PYTHON SOURCE LINES 51-52

Fit transform the data

.. GENERATED FROM PYTHON SOURCE LINES 52-54

.. code-block:: default

    out = marker.fit_transform(input)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2022-12-02 10:02:28,050 - JUNIFER - INFO - Computing BOLD
    2022-12-02 10:02:28,050 - JUNIFER - INFO - Fetching one of Schaefer parcellations.
    2022-12-02 10:02:28,050 - JUNIFER - INFO - Parcellatikon parameters:
    2022-12-02 10:02:28,050 - JUNIFER - INFO -      n_rois: 100
    2022-12-02 10:02:28,050 - JUNIFER - INFO -      yeo_networks: 7
    2022-12-02 10:02:28,051 - JUNIFER - INFO -      resolution: 3.0
    2022-12-02 10:02:28,051 - JUNIFER - INFO - At least one of the parcellation files are missing. Fetching using nilearn.

    Dataset created in /home/runner/junifer/data/parcellations/schaefer_2018

    Downloading data from https://raw.githubusercontent.com/ThomasYeoLab/CBIG/v0.14.3-Update_Yeo2011_Schaefer2018_labelname/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal/Parcellations/MNI/Schaefer2018_100Parcels_7Networks_order.txt ...
     ...done. (0 seconds, 0 min)
    Downloading data from https://raw.githubusercontent.com/ThomasYeoLab/CBIG/v0.14.3-Update_Yeo2011_Schaefer2018_labelname/stable_projects/brain_parcellation/Schaefer2018_LocalGlobal/Parcellations/MNI/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz ...
     ...done. (0 seconds, 0 min)
    2022-12-02 10:02:28,532 - JUNIFER - INFO - Loading parcellation /home/runner/junifer/data/parcellations/schaefer_2018/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz
    2022-12-02 10:02:29,874 - JUNIFER - INFO - No storage specified, returning dictionary
    2022-12-02 10:02:29,874 - JUNIFER - INFO - Computing VBM_GM
    2022-12-02 10:02:29,874 - JUNIFER - INFO - Fetching one of Schaefer parcellations.
    2022-12-02 10:02:29,874 - JUNIFER - INFO - Parcellatikon parameters:
    2022-12-02 10:02:29,874 - JUNIFER - INFO -      n_rois: 100
    2022-12-02 10:02:29,874 - JUNIFER - INFO -      yeo_networks: 7
    2022-12-02 10:02:29,874 - JUNIFER - INFO -      resolution: 2.0
    2022-12-02 10:02:29,876 - JUNIFER - INFO - Loading parcellation /home/runner/junifer/data/parcellations/schaefer_2018/Schaefer2018_100Parcels_7Networks_order_FSLMNI152_2mm.nii.gz
    2022-12-02 10:02:30,480 - JUNIFER - INFO - No storage specified, returning dictionary




.. GENERATED FROM PYTHON SOURCE LINES 55-56

Check the results

.. GENERATED FROM PYTHON SOURCE LINES 56-62

.. code-block:: default


    print(out.keys())
    print(out["VBM_GM"]["data"].shape)  # Shape is (1 x parcels)

    print(out.keys())
    print(out["BOLD"]["data"].shape)  # Shape is (timepoints x parcels)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    dict_keys(['BOLD', 'VBM_GM'])
    (1, 100)
    dict_keys(['BOLD', 'VBM_GM'])
    (96, 100)





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 8 minutes  36.736 seconds)


.. _sphx_glr_download_auto_examples_run_compute_parcel_mean.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: run_compute_parcel_mean.py <run_compute_parcel_mean.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: run_compute_parcel_mean.ipynb <run_compute_parcel_mean.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
