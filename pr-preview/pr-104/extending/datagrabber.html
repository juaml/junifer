<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="5. Examples" href="../auto_examples/index.html" /><link rel="prev" title="4. Extending junifer" href="index.html" />

    <meta name="generator" content="sphinx-5.3.0, furo 2022.09.29"/>
        <title>4.1. Creating DataGrabbers - junifer documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">junifer  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/junifer_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">junifer  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installing junifer</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../understanding/index.html">2. Understanding junifer</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../understanding/data.html">2.1. The Data Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding/datagrabber.html">2.2. DataGrabber</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding/datareader.html">2.3. DataReader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding/preprocess.html">2.4. Preprocess</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding/marker.html">2.5. Marker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding/storage.html">2.6. Storage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../builtin.html">3. Pipeline steps and atlases</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">4. Extending junifer</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">4.1. Creating DataGrabbers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">5. Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/run_compute_parcel_mean.html">5.1. Computer Parcel Aggregation.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/norun_ukbvm_gmd.html">5.2. UKB VBM GMD Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/run_datagrabber_bids_datalad.html">5.3. Generic BIDS datagrabber for datalad.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/run_run_gmd_mean.html">5.4. UKB VBM GMD Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/run_ets_rss_marker.html">5.5. Extracting root sum of squares from edge-wise timeseries.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/norun_hcpfc_pearson.html">5.6. HCP FC Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/run_junifer_julearn.html">5.7. Run junifer and julearn.</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">6. API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/datagrabbers.html">6.1.1. DataGrabbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/datareaders.html">6.1.2. DataReaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/preprocessing.html">6.1.3. Pre-processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/markers.html">6.1.4. Markers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/storage.html">6.1.5. Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">6.2.1. Atlases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html#module-junifer.data.coordinates">6.2.2. Coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/stats.html">6.2.3. Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pipeline.html">6.2.4. Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pipeline.html#module-junifer.pipeline.registry">6.2.5. Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/api.html">6.2.6. API Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">6.2.7. Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/testing.html">6.2.8. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/configs.html">6.3.1. Configs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">7. Contributing to junifer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintaining.html">8. Maintaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">9. FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">10. What’s new</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="creating-datagrabbers">
<span id="extending-datagrabbers"></span><h1><span class="section-number">4.1. </span>Creating DataGrabbers<a class="headerlink" href="#creating-datagrabbers" title="Permalink to this heading">#</a></h1>
<p>DataGrabbers are the first step of the pipeline. It’s purpose is to interpret
the structure of a dataset and provide two specific functionalities:</p>
<ol class="arabic simple">
<li><p>Given an <em>element</em>, provide the path to each kind of data available for this
element (e.g. the path to the T1 image, the path to the T2 image, etc.)</p></li>
<li><p>Provide the list of <em>elements</em> available in the dataset.</p></li>
</ol>
<p>In this section, we will see how to create a datagrabber for a dataset. Basic
aspects of datagrabbers are covedered in the
<a class="reference internal" href="../understanding/datagrabber.html#datagrabber"><span class="std std-ref">Understanding DataGrabbers</span></a> section.</p>
<section id="step-1-think-about-the-element">
<span id="extending-datagrabbers-think"></span><h2><span class="section-number">4.1.1. </span>Step 1: Think about the element<a class="headerlink" href="#step-1-think-about-the-element" title="Permalink to this heading">#</a></h2>
<p>Like with any programming-related task, the first step is to think. When
creating a DataGrabber, we need to first define what an <em>element</em> is.
The <em>element</em> should be the smallest unit of data that can be processed. That
is, for each element, there should be a set of data that can be processed, but
only one of each <em>data type</em> (see <a class="reference internal" href="../understanding/data.html#data-types"><span class="std std-ref">Data types</span></a>).</p>
<p>For example, if we have a dataset from an fMRI study in which:</p>
<ol class="loweralpha simple">
<li><p>both T1w and fMRI was acquired</p></li>
<li><p>20 subjects went through a experiment twice</p></li>
<li><p>the experiment included resting-stage fMRI and a task named <em>stroop</em></p></li>
</ol>
<p>then the <em>element</em> should be composed of 3 items:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subject</span></code>: The subject IDs, e.g. <cite>sub001</cite>, <cite>sub002</cite>, … <cite>sub020</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">session</span></code>: The sesion number, e.g. <cite>ses1</cite>, <cite>ses2</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code>: The task performed, e.g. <cite>rest</cite>, <cite>stroop</cite></p></li>
</ul>
<p>If any of this items were not part of the element, then we will have more than
one <code class="docutils literal notranslate"><span class="pre">T1w</span></code> and/or <code class="docutils literal notranslate"><span class="pre">BOLD</span></code> image for each subject, which is not allowed.</p>
<p>Importantly, nothing prevents that one image is part of two different elements.
For example, it is usually the case that the <code class="docutils literal notranslate"><span class="pre">T1w</span></code> image is not acquired for
each task, but once in the entire session. So in this case, the <code class="docutils literal notranslate"><span class="pre">T1w</span></code> image
for the element (<code class="docutils literal notranslate"><span class="pre">sub001</span></code>, <code class="docutils literal notranslate"><span class="pre">ses1</span></code>, <code class="docutils literal notranslate"><span class="pre">rest</span></code>) will be the same as the
<code class="docutils literal notranslate"><span class="pre">T1w</span></code> image for the element (<code class="docutils literal notranslate"><span class="pre">sub001</span></code>, <code class="docutils literal notranslate"><span class="pre">ses1</span></code>, <code class="docutils literal notranslate"><span class="pre">stroop</span></code>).</p>
<p>We will now continue this section using as an example, a dataset in BIDS format
in which each 9 subjects (<cite>sub-01</cite> to <cite>sub-09</cite>) were scanned each in 3
sessions (<cite>ses-01</cite>, <cite>ses-02</cite>, <cite>ses-03</cite>) and each session included a <cite>T1w</cite> and
a <cite>BOLD</cite> image (resting-state), except for <cite>ses-03</cite> which was only anatomical.</p>
</section>
<section id="step-2-think-about-the-dataset-s-structure">
<h2><span class="section-number">4.1.2. </span>Step 2: Think about the dataset’s structure<a class="headerlink" href="#step-2-think-about-the-dataset-s-structure" title="Permalink to this heading">#</a></h2>
<p>Now that we have our element defined, we need to think about the structure of
the dataset. Mainly, because the structure of the dataset will determine how
the DataGrabber needs to be implemented.</p>
<p>Junifer provides an abstract class to deal with datasets that can be thought in
terms of <em>patterns</em>. A <em>pattern</em> is a string that contains placeholders that are
replaced by the actual values of the element. In our BIDS example, the path
to the T1w image of subject <cite>sub-01</cite> and session <cite>ses-01</cite>, relative to the
dataset location, is <code class="docutils literal notranslate"><span class="pre">sub-01/ses-01/anat/sub-01_ses-01_T1w.nii.gz</span></code>. By
replacing <code class="docutils literal notranslate"><span class="pre">sub-01</span></code> with <code class="docutils literal notranslate"><span class="pre">sub-02</span></code>, we can obtain the T1w image of the first
session of the second subject. Indeed, the path to the T1w images can be
expressed as a pattern:</p>
<p><code class="docutils literal notranslate"><span class="pre">{subject}/{session}/anat/{subject}_{session}_T1w.nii.gz</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">{subject}</span></code> is the replacement for the subject id and <code class="docutils literal notranslate"><span class="pre">{session}}</span></code>
is the replacement for the session id.</p>
<p>Since it is a BIDS dataaset, the same happens with the BOLD images. The path to
the BOLD images can be expressed as a pattern:</p>
<p><code class="docutils literal notranslate"><span class="pre">{subject}/{session}/func/{subject}_{session}_task-rest_bold.nii.gz</span></code></p>
<p>This will be the norm in most of the datasets. If your dataset can be expressed
in terms of patterns, then follow <a class="reference internal" href="#extending-datagrabbers-pattern"><span class="std std-ref">Option A: Extending from PatternDataGrabber</span></a>.
Otherwise, we recommend that you take time to re-think about your dataset
structure and why it does not have clear <em>patterns</em>. Feel free to open a
discussion in the <a class="reference external" href="https://github.com/juaml/junifer/discussions">junifer Discussions</a> page. Most probably we can help you
get your dataset in order.</p>
<p>If there is no other way, then you can follow <a class="reference internal" href="#extending-datagrabbers-base"><span class="std std-ref">Option B: Extending from BaseDataGrabber</span></a>
to create a DataGrabber from scratch.</p>
</section>
<section id="option-a-extending-from-patterndatagrabber">
<span id="extending-datagrabbers-pattern"></span><h2><span class="section-number">4.1.3. </span>Option A: Extending from PatternDataGrabber<a class="headerlink" href="#option-a-extending-from-patterndatagrabber" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference internal" href="../api/datagrabbers.html#junifer.datagrabber.PatternDataGrabber" title="junifer.datagrabber.PatternDataGrabber"><code class="xref py py-class docutils literal notranslate"><span class="pre">PatternDataGrabber</span></code></a> class is an
abstract class that has the functionality of understanding patterns embeded
in it.</p>
<p>Before creating the datagrabber, we need to define 3 variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">types</span></code>: A list with the available <a class="reference internal" href="../understanding/data.html#data-types"><span class="std std-ref">Data types</span></a> in our dataset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">patterns</span></code>: A dictionary that specifies the pattern for each data type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">replacements</span></code>: A list indicating which of the elements in the patterns
should be replaced by the values of the element.</p></li>
</ul>
<p>For example, in our BIDS example, the variables will be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;T1w&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLD&quot;</span><span class="p">]</span>
<span class="n">patterns</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;T1w&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/anat/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_T1w.nii.gz&quot;</span><span class="p">,</span>
   <span class="s2">&quot;BOLD&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/func/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_task-rest_bold.nii.gz&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">replacements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;session&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>An additional fourth variable is the <code class="docutils literal notranslate"><span class="pre">datadir</span></code>, which should be the path to
where the dataset is located. For example, if the dataset is located in
<code class="docutils literal notranslate"><span class="pre">/data/project/test/data</span></code>, then <code class="docutils literal notranslate"><span class="pre">datadir</span></code> should be
<code class="docutils literal notranslate"><span class="pre">/data/project/test/data</span></code>. Or, if we want to allow the user to specify the
location of the dataset, we can expose the variable in the constructor, as in
this example</p>
<p>With this defined, we can now create our datagrabber, we will name it
<code class="docutils literal notranslate"><span class="pre">ExampleBIDSDataGrabber</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">junifer.datagrabber.pattern</span> <span class="kn">import</span> <span class="n">PatternDataGrabber</span>

<span class="k">class</span> <span class="nc">ExampleBIDSDataGrabber</span><span class="p">(</span><span class="n">PatternDataGrabber</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datadir</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;T1w&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLD&quot;</span><span class="p">]</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="p">{</span>
           <span class="s2">&quot;T1w&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/anat/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_T1w.nii.gz&quot;</span><span class="p">,</span>
           <span class="s2">&quot;BOLD&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/func/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_task-rest_bold.nii.gz&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;session&quot;</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
           <span class="n">datadir</span><span class="o">=</span><span class="n">datadir</span><span class="p">,</span>
           <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
           <span class="n">patterns</span><span class="o">=</span><span class="n">patterns</span><span class="p">,</span>
           <span class="n">replacements</span><span class="o">=</span><span class="n">replacements</span><span class="p">)</span>
</pre></div>
</div>
<p>Our datagrabber is ready to be used by junifer. However, it is still unknown
to the library. We need to register it in the library. To do so, we need to
use the <a class="reference internal" href="../api/api.html#junifer.api.decorators.register_datagrabber" title="junifer.api.decorators.register_datagrabber"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_datagrabber()</span></code></a> decorator.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">junifer.datagrabber.pattern</span> <span class="kn">import</span> <span class="n">PatternDataGrabber</span>
<span class="kn">from</span> <span class="nn">junifer.api.decorators</span> <span class="kn">import</span> <span class="n">register_datagrabber</span>


<span class="nd">@register_datagrabber</span>
<span class="k">class</span> <span class="nc">ExampleBIDSDataGrabber</span><span class="p">(</span><span class="n">PatternDataGrabber</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datadir</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;T1w&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLD&quot;</span><span class="p">]</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="p">{</span>
           <span class="s2">&quot;T1w&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/anat/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_T1w.nii.gz&quot;</span><span class="p">,</span>
           <span class="s2">&quot;BOLD&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/func/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_task-rest_bold.nii.gz&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;session&quot;</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
           <span class="n">datadir</span><span class="o">=</span><span class="n">datadir</span><span class="p">,</span>
           <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
           <span class="n">patterns</span><span class="o">=</span><span class="n">patterns</span><span class="p">,</span>
           <span class="n">replacements</span><span class="o">=</span><span class="n">replacements</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we can use our datagrabber in junifer, by setting the <code class="docutils literal notranslate"><span class="pre">datagrabber</span></code> kind
in the yaml file to <code class="docutils literal notranslate"><span class="pre">ExampleBIDSDataGrabber</span></code>. Remember that we still need to
set the <code class="docutils literal notranslate"><span class="pre">datadir</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">datagrabber</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExampleBIDSDataGrabber</span><span class="w"></span>
<span class="w">   </span><span class="nt">datadir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/project/test/data</span><span class="w"></span>
</pre></div>
</div>
<section id="optional-using-datalad">
<h3><span class="section-number">4.1.3.1. </span>Optional: Using datalad<a class="headerlink" href="#optional-using-datalad" title="Permalink to this heading">#</a></h3>
<p>If you are using datalad, you can use the
<a class="reference internal" href="../api/datagrabbers.html#junifer.datagrabber.PatternDataladDataGrabber" title="junifer.datagrabber.PatternDataladDataGrabber"><code class="xref py py-class docutils literal notranslate"><span class="pre">PatternDataladDataGrabber</span></code></a> instead of the
<a class="reference internal" href="../api/datagrabbers.html#junifer.datagrabber.PatternDataGrabber" title="junifer.datagrabber.PatternDataGrabber"><code class="xref py py-class docutils literal notranslate"><span class="pre">PatternDataGrabber</span></code></a>. This class will also
interpret patterns, but will also use datalad to <cite>clone</cite> and <cite>get</cite> the data.</p>
<p>The main difference between the two is that the <code class="docutils literal notranslate"><span class="pre">datadir</span></code> is not the actual
location of the dataset, but the location where the dataset will be cloned. It
can now be <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means that the data will be downloaded to a
temporary directory. To set the location of the dataset, you can use the
<code class="docutils literal notranslate"><span class="pre">uri</span></code> argument in the constructor. Additionally, a <code class="docutils literal notranslate"><span class="pre">rootdir</span></code> argument can
be used to specify the path to the root directory of the dataset after doing
<code class="docutils literal notranslate"><span class="pre">datalad</span> <span class="pre">clone</span></code></p>
<p>In the example, the dataset is hosted in gin
(<code class="docutils literal notranslate"><span class="pre">https://gin.g-node.org/juaml/datalad-example-bids</span></code>).</p>
<p>When we clone this dataset, we will see the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
└── example_bids_ses
   ├── sub-01
   │   ├── ses-01
   │   ├── ses-02
   │   └── ses-03
   ├── sub-02
   │   ├── ses-01
   │   ├── ses-02
   │   └── ses-03
   ├── sub-03
   ...
</pre></div>
</div>
<p>So the patterns will start after <code class="docutils literal notranslate"><span class="pre">example_bids_ses</span></code>. This is our <code class="docutils literal notranslate"><span class="pre">rootdir</span></code>.</p>
<p>Now we have our 2 additional variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;https://gin.g-node.org/juaml/datalad-example-bids&quot;</span>
<span class="n">rootdir</span> <span class="o">=</span> <span class="s2">&quot;example_bids_ses&quot;</span>
</pre></div>
</div>
<p>And we can create our datagrabber:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">junifer.datagrabber.pattern</span> <span class="kn">import</span> <span class="n">PatternDataladDataGrabber</span>
<span class="kn">from</span> <span class="nn">junifer.api.decorators</span> <span class="kn">import</span> <span class="n">register_datagrabber</span>


<span class="nd">@register_datagrabber</span>
<span class="k">class</span> <span class="nc">ExampleBIDSDataGrabber</span><span class="p">(</span><span class="n">PatternDataladDataGrabber</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;T1w&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLD&quot;</span><span class="p">]</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="p">{</span>
           <span class="s2">&quot;T1w&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/anat/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_T1w.nii.gz&quot;</span><span class="p">,</span>
           <span class="s2">&quot;BOLD&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{subject}</span><span class="s2">/</span><span class="si">{session}</span><span class="s2">/func/</span><span class="si">{subject}</span><span class="s2">_</span><span class="si">{session}</span><span class="s2">_task-rest_bold.nii.gz&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;session&quot;</span><span class="p">]</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;https://gin.g-node.org/juaml/datalad-example-bids&quot;</span>
        <span class="n">rootdir</span> <span class="o">=</span> <span class="s2">&quot;example_bids_ses&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
           <span class="n">datadir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span>
           <span class="n">rootdir</span><span class="o">=</span><span class="n">rootdir</span><span class="p">,</span>
           <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
           <span class="n">patterns</span><span class="o">=</span><span class="n">patterns</span><span class="p">,</span>
           <span class="n">replacements</span><span class="o">=</span><span class="n">replacements</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="option-b-extending-from-basedatagrabber">
<span id="extending-datagrabbers-base"></span><h2><span class="section-number">4.1.4. </span>Option B: Extending from BaseDataGrabber<a class="headerlink" href="#option-b-extending-from-basedatagrabber" title="Permalink to this heading">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../auto_examples/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">5. </span>Examples</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">4. </span>Extending junifer</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Authors of junifer
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">4.1. Creating DataGrabbers</a><ul>
<li><a class="reference internal" href="#step-1-think-about-the-element">4.1.1. Step 1: Think about the element</a></li>
<li><a class="reference internal" href="#step-2-think-about-the-dataset-s-structure">4.1.2. Step 2: Think about the dataset’s structure</a></li>
<li><a class="reference internal" href="#option-a-extending-from-patterndatagrabber">4.1.3. Option A: Extending from PatternDataGrabber</a><ul>
<li><a class="reference internal" href="#optional-using-datalad">4.1.3.1. Optional: Using datalad</a></li>
</ul>
</li>
<li><a class="reference internal" href="#option-b-extending-from-basedatagrabber">4.1.4. Option B: Extending from BaseDataGrabber</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/js/custom.js"></script>
    </body>
</html>